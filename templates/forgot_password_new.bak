{% extends 'base.html' %}
{% block content %}
  <!-- Template Version: 2FA Email Integration Active -->
  <div class="card-header">
    <h1>üîì Forgot Password</h1>
    <p class="note">Choose from multiple recovery options including secure email reset.</p>
  </div>
  <div class="card-body">
    {% if message %}
      <div class="message {{ 'success' if success else ('error' if error else '') }}">{{ message }}</div>
    {% endif %}
    
    <!-- Password Recovery Options -->
    <div class="recovery-options">
      
      <!-- OPTION 1: EMAIL PASSWORD RESET -->
      <div class="recovery-card email-reset-card">
        <div class="recovery-icon">üìß</div>
        <h3>Email Password Reset</h3>
        <p>Send a secure password reset link to your department administrators.</p>
        
        <form method="post" class="request-form">
          <input type="hidden" name="action" value="send_reset_email">
          
          <div class="form-group">
            <label class="form-label">Select Department:</label>
            <select name="department" class="form-select" required>
              <option value="">Select your department...</option>
              {% for dept in departments %}
                <option value="{{ dept }}">{{ dept }}</option>
              {% endfor %}
            </select>
          </div>
          
          <div class="form-actions">
            <button type="submit" class="btn-primary">Send Reset Email</button>
          </div>
        </form>
      </div>
      
      <!-- OPTION 2: CONTACT ADMIN -->
      <div class="recovery-card">
        <div class="recovery-icon">üë®‚Äçüíº</div>
        <h3>Contact System Administrator</h3>
        <p>The quickest way to recover your department password is to contact your system administrator.</p>
        <div class="contact-info">
          <strong>Admin Contact:</strong><br>
          üìß Email: admin@yourcompany.com<br>
          üìû Phone: +1-XXX-XXX-XXXX<br>
          üí¨ Teams: @ITSupport
        </div>
      </div>
      
      <!-- OPTION 3: PASSWORD HINTS -->
      <div class="recovery-card">
        <div class="recovery-icon">üí°</div>
        <h3>Password Hints</h3>
        <p>Department passwords typically follow these patterns:</p>
        <div class="hint-list">
          <div class="hint-item">‚Ä¢ Department name + "123" (e.g., service123)</div>
          <div class="hint-item">‚Ä¢ Department abbreviation + "123" (e.g., toc123)</div>
          <div class="hint-item">‚Ä¢ Check with your team lead or manager</div>
          <div class="hint-item">‚Ä¢ Look for shared team documentation</div>
        </div>
      </div>
      
      <!-- OPTION 4: EMERGENCY REQUEST -->
      <div class="recovery-card">
        <div class="recovery-icon">üÜò</div>
        <h3>Emergency Access Request</h3>
        <p>Submit a request for temporary access to your department.</p>
        
        <form method="post" class="request-form">
          <input type="hidden" name="action" value="emergency_request">
          
          <div class="form-group">
            <label class="form-label">Your Name:</label>
            <input type="text" name="requester_name" class="form-input" required placeholder="Enter your full name">
          </div>
          
          <div class="form-group">
            <label class="form-label">Department:</label>
            <select name="department" class="form-select" required>
              <option value="">Select your department...</option>
              {% for dept in departments %}
                <option value="{{ dept }}">{{ dept }}</option>
              {% endfor %}
            </select>
          </div>
          
          <div class="form-group">
            <label class="form-label">Email (for response):</label>
            <input type="email" name="email" class="form-input" required placeholder="your.email@company.com">
          </div>
          
          <div class="form-group">
            <label class="form-label">Reason for Request:</label>
            <textarea name="reason" class="form-textarea" rows="3" required placeholder="Brief explanation of why you need access..."></textarea>
          </div>
          
          <div class="form-actions">
            <button type="submit" class="btn-primary">Submit Request</button>
          </div>
        </form>
      </div>
      
    </div>
    
    <!-- Back to Login -->
    <div class="back-section">
      <a href="{{ url_for('local_login') }}" class="back-link">‚Üê Back to Login</a>
      <a href="{{ url_for('index') }}" class="back-link">üè† Go to Home</a>
    </div>
    
  </div>
  
  <style>
    .recovery-options {
      display: grid;
      gap: 2rem;
      margin-bottom: 2rem;
    }
    
    .recovery-card {
      background: var(--bg-secondary);
      padding: 2rem;
      border-radius: var(--radius-lg);
      border: 1px solid var(--border-color);
      text-align: center;
    }
    
    .email-reset-card {
      border: 2px solid #3b82f6;
      background: linear-gradient(135deg, #eff6ff 0%, var(--bg-secondary) 100%);
    }
    
    .recovery-icon {
      font-size: 3rem;
      margin-bottom: 1rem;
      display: block;
    }
    
    .recovery-card h3 {
      margin: 0 0 1rem 0;
      color: var(--text-primary);
      font-size: 1.3rem;
    }
    
    .recovery-card p {
      color: var(--text-secondary);
      margin-bottom: 1.5rem;
      line-height: 1.6;
    }
    
    .contact-info {
      background: var(--bg-tertiary);
      padding: 1rem;
      border-radius: var(--radius-md);
      font-size: 0.9rem;
      line-height: 1.8;
      color: var(--text-primary);
    }
    
    .hint-list {
      text-align: left;
      max-width: 400px;
      margin: 0 auto;
    }
    
    .hint-item {
      background: var(--bg-tertiary);
      padding: 0.75rem;
      margin-bottom: 0.5rem;
      border-radius: var(--radius-md);
      color: var(--text-primary);
      font-size: 0.9rem;
    }
    
    .request-form {
      text-align: left;
      max-width: 400px;
      margin: 0 auto;
    }
    
    .form-group {
      margin-bottom: 1.5rem;
    }
    
    .form-label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
      color: var(--text-primary);
    }
    
    .form-input, .form-select, .form-textarea {
      width: 100%;
      padding: 0.75rem;
      border: 2px solid var(--border-color);
      border-radius: var(--radius-md);
      font-size: 1rem;
      transition: border-color 0.2s ease;
      background: var(--bg-primary);
    }
    
    .form-input:focus, .form-select:focus, .form-textarea:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(100, 116, 139, 0.1);
    }
    
    .form-textarea {
      resize: vertical;
      font-family: inherit;
    }
    
    .form-actions {
      text-align: center;
      margin-top: 2rem;
    }
    
    .btn-primary {
      background: var(--primary-color);
      color: white;
      border: none;
      padding: 0.75rem 2rem;
      border-radius: var(--radius-md);
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 1rem;
      font-weight: 500;
    }
    
    .btn-primary:hover {
      background: var(--primary-dark);
      transform: translateY(-2px);
    }
    
    .back-section {
      text-align: center;
      margin-top: 3rem;
      padding-top: 2rem;
      border-top: 1px solid var(--border-color);
      display: flex;
      justify-content: center;
      gap: 2rem;
      flex-wrap: wrap;
    }
    
    .back-link {
      color: var(--primary-color);
      text-decoration: none;
      font-weight: 500;
      transition: all 0.2s ease;
      padding: 0.5rem 1rem;
      border-radius: var(--radius-md);
      border: 1px solid var(--border-color);
    }
    
    .back-link:hover {
      background: var(--bg-secondary);
      transform: translateY(-1px);
      color: var(--primary-dark);
    }
    
    .message {
      padding: 1rem;
      border-radius: var(--radius-md);
      margin-bottom: 2rem;
      text-align: center;
      font-weight: 500;
    }
    
    .message.success {
      background: #dcfce7;
      color: #166534;
    }
    
    .message.error {
      background: #fee2e2;
      color: #dc2626;
    }
    
    @media (max-width: 768px) {
      .recovery-options {
        gap: 1.5rem;
      }
      
      .recovery-card {
        padding: 1.5rem;
      }
      
      .back-section {
        flex-direction: column;
        gap: 1rem;
      }
    }
  </style>
{% endblock %}